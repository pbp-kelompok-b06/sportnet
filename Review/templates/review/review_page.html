{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="max-w-4xl mx-auto mt-24">
  <h1 class="text-2xl font-bold mb-4 text-[var(--color-main-700)]">
    Review Event: {{ event.name }}
  </h1>
  {% if authen %}
  <form method="POST" class="mb-6 bg-white p-4 rounded-xl shadow">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit" class="btn btn-gradient w-full mt-2">Kirim Review</button>
  </form>
  {% else %}
  <p class="text-gray-500 mb-6">Anda telah memberikan review untuk event ini.</p>
  {% endif %}
  <div class="space-y-4">
    {% for review in reviews %}
      <div class="bg-[var(--color-main-50)] p-4 rounded-lg shadow">
        <p class="font-semibold">{{ review.participant.full_name }}</p>
        <div class="flex items-center mb-2">
          {% for i in "12345" %}
            {% if forloop.counter <= review.rating %}
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="#FF773D" viewBox="0 0 20 20" class="inline-block mr-1">
                <polygon points="10,1 12.59,6.99 19,7.64 14,12.26 15.18,18.51 10,15.27 4.82,18.51 6,12.26 1,7.64 7.41,6.99"/>
              </svg>
            {% else %}
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="#E5E7EB" viewBox="0 0 20 20" class="inline-block mr-1">
                <polygon points="10,1 12.59,6.99 19,7.64 14,12.26 15.18,18.51 10,15.27 4.82,18.51 6,12.26 1,7.64 7.41,6.99"/>
              </svg>
            {% endif %}
          {% endfor %}
        </div>
        <p class="text-gray-800">{{ review.comment }}</p> 
        <p class="text-sm text-gray-500 mt-1">{{ review.created_at|date:"d M Y, H:i" }}</p>
      </div>
    {% empty %}
      <p class="text-gray-500">Belum ada review untuk event ini.</p>
    {% endfor %}
  </div>
</div>
<script>
  function starRating(reviews){
    const starContainer = document.getElementById('star-rating');
    for (let i = 0; i < reviews.rating; i++) {
      const star = document.createElementNS("http://www.w3.org/2000/svg", "svg");
      star.setAttribute("width", "300");
      star.setAttribute("height", "200");
      const polygon = document.createElementNS("http://www.w3.org/2000/svg", "polygon");
      polygon.setAttribute("points", "100,10 40,198 190,78 10,78 160,198");
      polygon.setAttribute("style", "fill:#FF773D;stroke-width:5;");
      star.appendChild(polygon);
      starContainer.appendChild(star);
    }
  }
</script>
{% endblock %}